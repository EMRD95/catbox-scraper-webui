<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Catbox MP4 Finder</title>
  <style>
    body {
      margin: 0; padding: 0; background: #000; color: #fff; 
      font-family: sans-serif; padding-top: 60px; 
    }
    header {
      position: fixed; top: 0; left: 0; width: 100%;
      background: #222; text-align: center; padding: 10px; z-index: 999;
    }
    #stats, #controls { margin: 5px; }
    button {
      background: #555; color: #fff; border: none; padding: 8px;
      border-radius: 5px; margin: 5px; cursor: pointer;
    }
    #startBtn { background: #28a745; }
    #stopBtn  { background: #dc3545; }
    /* Container: full width on mobile, up to 900px on desktop */
    #container {
      width: 100%; max-width: 900px; margin: 80px auto 0; 
      padding: 0 10px; /* small side padding for desktop */
    }
    .videoItem {
      width: 100%; margin: 0; padding: 0; margin-bottom: 20px;
      background: #111; border-radius: 5px; overflow: hidden;
    }
    .videoItem video {
      display: block; width: 100%; height: auto; object-fit: contain; background: #000;
    }
    footer {
      text-align: center; padding: 10px; background: #111; margin-top: 30px; 
      color: #aaa; font-size: 14px;
    }
  </style>
</head>
<body>

<header>
  <div id="stats">
    Time: <span id="timeEl">00:00:00</span> | 
    Checks: <span id="checksEl">0</span> | 
    Hits: <span id="hitsEl">0</span> | 
    /s: <span id="speedEl">0</span>
  </div>
  <div id="controls">
    <button id="startBtn">Start</button>
    <button id="stopBtn" disabled>Stop</button>
  </div>
</header>

<div id="container"></div>

<footer>
  Be patient. If no hits at all within 10 minutes, something may be wrong.
</footer>

<script>
/* Minimal single-interval .MP4 finder with notifications */

const TEST_VIDEOS = [
  "https://files.catbox.moe/mwx2pr.mp4",
  "https://files.catbox.moe/0qo5p2.mp4"
];

let checks=0, hits=0, interval=null, startTime=0, stopFlag=false;

function randomString(n=6){
  const chars="abcdefghijklmnopqrstuvwxyz0123456789";
  let out="";
  while(out.length<n) out+=chars[Math.floor(Math.random()*chars.length)];
  return out;
}

function formatTime(sec){
  let h=Math.floor(sec/3600), m=Math.floor((sec%3600)/60), s=Math.floor(sec%60);
  return `${String(h).padStart(2,"0")}:${String(m).padStart(2,"0")}:${String(s).padStart(2,"0")}`;
}

function updateStats(){
  const elapsed=(Date.now()-startTime)/1000;
  document.getElementById("timeEl").textContent=formatTime(elapsed);
  document.getElementById("checksEl").textContent=checks;
  document.getElementById("hitsEl").textContent=hits;
  document.getElementById("speedEl").textContent=(checks/elapsed).toFixed(2);
}

function showVideo(url){
  const wrap=document.createElement("div");
  wrap.className="videoItem";
  const vid=document.createElement("video");
  vid.src=url; 
  vid.controls=true;
  wrap.appendChild(vid);
  document.getElementById("container").appendChild(wrap);
}

function checkRandomMp4(){
  if(stopFlag) return;
  checks++;
  const url="https://files.catbox.moe/"+randomString()+".mp4";
  const probe=document.createElement("video");
  probe.src=url;
  probe.onloadedmetadata=()=>{
    hits++;
    showVideo(url);
    if(Notification.permission==="granted"){
      new Notification("Catbox Hit Found",{body:url});
    }
  };
}

function step(){
  checkRandomMp4();
  updateStats();
}

function startScraping(){
  stopFlag=false;
  startTime=Date.now();
  if("Notification" in window) Notification.requestPermission();

  // Show known test videos
  TEST_VIDEOS.forEach(link=>{
    checks++;
    const tmp=document.createElement("video");
    tmp.src=link;
    tmp.onloadedmetadata=()=>{
      hits++;
      showVideo(link);
      if(Notification.permission==="granted"){
        new Notification("Catbox Hit Found",{body:link});
      }
    };
  });

  // Attempt about 10 random checks per second
  interval=setInterval(step,100);
}

function stopScraping(){
  stopFlag=true;
  clearInterval(interval);
}

// Buttons
document.getElementById("startBtn").onclick=()=>{
  if(interval) return;
  checks=0; hits=0; stopFlag=false;
  document.getElementById("container").innerHTML="";
  document.getElementById("startBtn").disabled=true;
  document.getElementById("stopBtn").disabled=false;
  startScraping();
};

document.getElementById("stopBtn").onclick=()=>{
  document.getElementById("startBtn").disabled=false;
  document.getElementById("stopBtn").disabled=true;
  stopScraping();
};
</script>

</body>
</html>
